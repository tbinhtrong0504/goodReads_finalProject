<!doctype html>
<html class="no-js" lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/layout :: main-fragment(
                                                ~{:: title},
                                                ~{:: #css},
                                                ~{:: #header},
                                                ~{:: #main-content},
                                                ~{:: #footer},
                                                ~{:: #js}
                                                )}">
<head>

    <title>Book - Detail</title>
    <th:block id="css">
        <link rel="stylesheet" th:href="@{/handle/reading-book-btn.css}">
        <style>

            .m-0 {
                margin: 0px;
            }

            .mt-20 {
                margin-top: 20px;
            }

            .mt-10 {
                margin-top: 10px;
            }

            .mt-10 {
                margin-top: 10px;
            }

            .mr-5 {
                margin-right: 5px;
            }

            .fs-12 {
                font-size: 12px;
            }

            .tg-productcontent {
                display: flex;
                flex-direction: column;
            }

            .stars svg {
                width: 25px;
                margin: 0 5px;
            }

            .tg-bookprice {
                margin-left: 10px;
            }

            #display-rating, #display-rating-personal {
                margin-top: 20px;
                display: flex;
                justify-content: center;
            }

            #display-rating {
                margin-bottom: 20px;
            }

            #review-book {
                display: flex;
                justify-content: center;
            }

            .tg-description {
                white-space: pre-line;
                margin-bottom: 20px;
            }

            #book-description {
                white-space: pre-line;
            }

            .truncate-description {
                display: -webkit-box;
                -webkit-line-clamp: 5;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }

            .truncate-description-2 {
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }

            .show-content {
                padding: 0 3px;
                font-weight: bolder;
                font-size: 11px;
                max-height: 28px;
            }

            .tg-productdescription #tg-comments img {
                width: 70px;
                height: 70px;
            }

            .tg-authorbox .tg-authorimg {
                width: 150px;
                background: #FCFCFC;
            }

            #tg-comments .following, #tg-comments .un-following {
                border-radius: 30px;
                min-width: 100px;
                text-align: center;
            }

            .p-0 {
                padding: 0px;
            }

            .tg-childcomment .tg-authorbox .tg-authorimg {
                width: 80px;
            }

            .tg-childcomment .tg-authorbox {
                padding: 20px 20px 0px 20px;
            }

            .display-rating-reivew .stars svg {
                width: 20px;
                margin: 0 3px;
            }

            .like-comment-review a {
                color: #484848;
                font-size: 13px !important;
                font-weight: 600;
            }

            .like-comment-review a:hover {
                color: #77b748;
            }

            .liked {
                color: red !important;
            }

            .disabled-link {
                pointer-events: none;
                color: gray;
            }

            .your-comment .register-page {
                color: #666;
                font-weight: 600;
            }

            .your-comment .register-page:hover {
                color: #77B748;
            }

        </style>
    </th:block>

</head>
<body>

<div id="tg-wrapper" class="tg-wrapper tg-haslayout">
    <!--************************************
            Header Start
    *************************************-->
    <th:block id="header" th:replace="fragments/header :: header"></th:block>
    <!--************************************
            Header End
    *************************************-->
    <th:block id="main-content" th:with="book=${bookDetail}">
        <!--************************************
                Inner Banner Start
        *************************************-->
        <div class="tg-innerbanner tg-haslayout tg-parallax tg-bginnerbanner" data-z-index="-100"
             data-appear-top-offset="600" data-parallax="scroll"
             th:attr="data-image-src=@{/original/images/parallax/bgparallax-07.jpg}">
            <div class="container">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                        <div class="tg-innerbannercontent">
                            <h1>Book Detail</h1>
                            <ol class="tg-breadcrumb">
                                <li><a href="/">home</a></li>
                                <li><a href="/books?pageIndex=1&pageSize=8">Books</a></li>
                                <li class="tg-active" th:text="${book.title}"></li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--************************************
                Inner Banner End
        *************************************-->
        <!--************************************
                Main Start
        *************************************-->
        <main id="tg-main" class="tg-main tg-haslayout">
            <!--************************************
                    News Grid Start
            *************************************-->
            <div class="tg-sectionspace tg-haslayout">
                <div class="container">
                    <div class="row">
                        <div id="tg-twocolumns" class="tg-twocolumns">
                            <div class="col-xs-12 col-sm-8 col-md-8 col-lg-9 pull-right">
                                <div id="tg-content" class="tg-content">

                                    <!--                                    <th:block th:replace="fragments/advertisement :: advertisement"></th:block>-->

                                    <div class="tg-productdetail">
                                        <div class="row">
                                            <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
                                                <div class="tg-postbook">
                                                    <figure class="tg-featureimg"><img th:src="${book.image}"
                                                                                       alt="image description"></figure>
                                                    <div class="tg-postbookcontent">
                                                        <th:block
                                                                th:replace="fragments/reading-book :: readingBook(${book.readingStatus},${book.id})"></th:block>

                                                        <a class="tg-btnaddtowishlist" th:href="${book.buyBook}"
                                                           target="_blank">
                                                            <span>Buy book on Fahasa.com</span>
                                                        </a>
                                                        <div id="display-rating-personal">
                                                            <a type="button" class="btn">

                                                                <div class="stars">
                                                                    <svg class="star" data-value="1"
                                                                         viewBox="0 0 940.688 940.688">
                                                                        <path
                                                                                d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                    </svg>
                                                                    <svg class="star" data-value="2"
                                                                         viewBox="0 0 940.688 940.688">
                                                                        <path
                                                                                d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                    </svg>
                                                                    <svg class="star" data-value="3"
                                                                         viewBox="0 0 940.688 940.688">
                                                                        <path
                                                                                d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                    </svg>
                                                                    <svg class="star" data-value="4"
                                                                         viewBox="0 0 940.688 940.688">
                                                                        <path
                                                                                d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                    </svg>
                                                                    <svg class="star" data-value="5"
                                                                         viewBox="0 0 940.688 940.688">
                                                                        <path
                                                                                d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                    </svg>

                                                                    <div class="overlay"
                                                                         th:attr="ratingDetail=${book.ratingDetail}"
                                                                         th:style="|width:${100-(book.ratingDetail*20)}%|">

                                                                    </div>
                                                                </div>
                                                            </a>
                                                        </div>
                                                        <div id="review-book"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
                                                <div class="tg-productcontent">
                                                    <ul class="tg-bookscategories"
                                                        th:with="categories=${book.categories}">
                                                        <li th:each="category:${categories}"><a
                                                                href="javascript:void(0);"
                                                                th:text="${category.name}">Art &amp;
                                                            Photography</a></li>
                                                    </ul>
                                                    <div class="tg-themetagbox"><span class="tg-themetag">sale</span>
                                                    </div>
                                                    <div class="tg-booktitle">
                                                        <h3 th:text="${book.title}">Drive Safely, No Bumping</h3>
                                                    </div>
                                                    <span class="tg-bookwriter">By: <a href="javascript:void(0);"
                                                                                       th:text="${book.author}">Angela Gunning</a></span>
                                                    <div id="display-rating">
                                                        <div class="stars">
                                                            <svg viewBox="0 0 940.688 940.688">
                                                                <path
                                                                        d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                            </svg>
                                                            <svg viewBox="0 0 940.688 940.688">
                                                                <path
                                                                        d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                            </svg>
                                                            <svg viewBox="0 0 940.688 940.688">
                                                                <path
                                                                        d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                            </svg>
                                                            <svg viewBox="0 0 940.688 940.688">
                                                                <path
                                                                        d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                            </svg>
                                                            <svg viewBox="0 0 940.688 940.688">
                                                                <path
                                                                        d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                            </svg>

                                                            <div class="overlay"
                                                                 th:attr="rating=${book.rating}"
                                                                 th:style="|width:${100-(book.rating*20)}%|"></div>

                                                        </div>
                                                        <span class="tg-bookprice">
                                                             <span> </span>

                                                                <span th:text="${book.rating}"
                                                                      style="font-weight: bolder; font-size: 23px; "></span>
                                                                <span>-</span>
                                                                <span th:text="${book.countOfRatings}"></span>
                                                                <span>ratings</span>
                                                            <span>-</span>
                                                                <span th:text="${book.countOfReviews}"></span>
                                                                <span>reviews</span>
                                                            </span>
                                                    </div>

                                                    <div class="tg-description">
                                                        <div id="book-description" class="truncate-description"
                                                             th:text="${book.description}">
                                                        </div>
                                                        <button id="show-more-btn" class="show-content"
                                                                onclick="showMore()">Show more<i
                                                                class="fa-solid fa-angle-down"></i>
                                                        </button>
                                                    </div>
                                                    <div class="tg-sectionhead">
                                                        <h2>Book Details</h2>
                                                    </div>
                                                    <ul class="tg-productinfo">
                                                        <li><span>Pages:</span>
                                                            <span th:text="${book.pages} + ' pages, Paperback' ">328</span>

                                                        </li>
                                                        <li><span>Publication Date:</span><span
                                                                th:text="${book.published}"></span>
                                                        </li>
                                                        <li><span>Publisher:</span><span>First new</span></li>
                                                        <li><span>Language:</span><span>Vietnamese</span></li>
                                                    </ul>

                                                </div>
                                            </div>
                                            <div class="tg-aboutauthor mt-20">
                                                <!--                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">-->
                                                <!--                                                    <div class="tg-sectionhead">-->
                                                <!--                                                        <h2>About Author</h2>-->
                                                <!--                                                    </div>-->
                                                <!--                                                    <div class="tg-authorbox">-->
                                                <!--                                                        <figure class="tg-authorimg">-->
                                                <!--                                                            <img th:src="@{/original/images/author/imag-02.jpg}"-->
                                                <!--                                                                 alt="image description">-->
                                                <!--                                                            <div class="tg-authorname mt-20">-->
                                                <!--                                                                &lt;!&ndash;//TODO: thêm thông tin của author&ndash;&gt;-->

                                                <!--                                                            </div>-->
                                                <!--                                                        </figure>-->
                                                <!--                                                        <div class="tg-authorinfo">-->
                                                <!--                                                            <div class="tg-authorhead">-->
                                                <!--                                                                <div class="tg-leftarea">-->
                                                <!--                                                                    <div class="tg-authorname">-->
                                                <!--                                                                        <h2 th:text="${book.author}">Kathrine-->
                                                <!--                                                                            Culbertson</h2>-->
                                                <!--                                                                        <span>Author Since: June 27, 2017</span>-->
                                                <!--                                                                    </div>-->
                                                <!--                                                                </div>-->
                                                <!--                                                                <div class="tg-rightarea">-->

                                                <!--                                                                    &lt;!&ndash;                                                                    TODO: thêm nút following&ndash;&gt;-->

                                                <!--                                                                    &lt;!&ndash;                                                                <th:block&ndash;&gt;-->
                                                <!--                                                                    &lt;!&ndash;                                                                        th:replace="fragments/following :: following(${review.following},${review.userReviewId})"></th:block>&ndash;&gt;-->
                                                <!--                                                                </div>-->
                                                <!--                                                            </div>-->
                                                <!--                                                            <div class="tg-description">-->
                                                <!--                                                                <p>Laborum sed ut perspiciatis unde omnis iste natus sit-->
                                                <!--                                                                    voluptatem accusantium doloremque laudantium totam-->
                                                <!--                                                                    rem-->
                                                <!--                                                                    aperiam eaque ipsa quae ab illo inventore veritatis-->
                                                <!--                                                                    etation.</p>-->
                                                <!--                                                            </div>-->
                                                <!--                                                            <a class="tg-btn tg-active" href="javascript:void(0);">View-->
                                                <!--                                                                All-->
                                                <!--                                                                Books</a>-->
                                                <!--                                                        </div>-->
                                                <!--                                                    </div>-->
                                                <!--                                                </div>-->
                                            </div>
                                            <div class="tg-productdescription mt-20">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                                    <div class="tg-sectionhead">
                                                        <h2>Ratings & Reviews</h2>
                                                    </div>
                                                    <ul class="tg-themetabs" role="tablist">
                                                        <li role="presentation" class="active"><a href="#my-review"
                                                                                                  data-toggle="tab">My
                                                            Review</a>
                                                        </li>
                                                        <li role="presentation"><a href="#review"
                                                                                   data-toggle="tab">Reviews</a>
                                                        </li>
                                                    </ul>
                                                    <div class="tg-tab-content tab-content">
                                                        <div role="tabpanel" class="tg-tab-pane tab-pane active"
                                                             id="my-review">
                                                            <div class="tg-commentsarea">
                                                                <th:block th:if="${myReview}==null">
                                                                    <ul id="tg-comments" class="tg-comments">
                                                                        <div class="tg-authorinfo"
                                                                             style="padding-bottom: 17px">
                                                                            <p><a href="/login" class="register-page">Sign
                                                                                in</a> or
                                                                                <a href="/signup" class="register-page">Create
                                                                                    a free account</a>
                                                                                to leave a comment and rating</p>
                                                                        </div>
                                                                        <div class="tg-bottomarrow"></div>
                                                                    </ul>
                                                                </th:block>
                                                                <th:block th:if="${myReview}!=null">
                                                                    <ul id="tg-comments" class="tg-comments"
                                                                        th:with="review=${myReview}">
                                                                        <li>
                                                                            <div class="tg-authorbox">
                                                                                <figure class="tg-authorimg"
                                                                                        id="avatar-my-review">
                                                                                    <img th:src="${review.avatar}"
                                                                                         alt="image description">
                                                                                    <div class="tg-authorname mt-20">
                                                                                        <h2 th:text="${review.name}">
                                                                                            Kathrine </h2>
                                                                                    </div>
                                                                                </figure>
                                                                                <div class="tg-authorinfo">
                                                                                    <div class="tg-authorhead">
                                                                                        <div class="tg-leftarea">
                                                                                            <div class="tg-authorname">
                                                                                                <div class="display-rating-reivew">
                                                                                                    <div class="stars">
                                                                                                        <svg viewBox="0 0 940.688 940.688">
                                                                                                            <path
                                                                                                                    d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                                                        </svg>
                                                                                                        <svg viewBox="0 0 940.688 940.688">
                                                                                                            <path
                                                                                                                    d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                                                        </svg>
                                                                                                        <svg viewBox="0 0 940.688 940.688">
                                                                                                            <path
                                                                                                                    d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                                                        </svg>
                                                                                                        <svg viewBox="0 0 940.688 940.688">
                                                                                                            <path
                                                                                                                    d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                                                        </svg>
                                                                                                        <svg viewBox="0 0 940.688 940.688">
                                                                                                            <path
                                                                                                                    d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                                                        </svg>

                                                                                                        <div class="overlay"
                                                                                                             th:attr="rating=${review.ratingDetail}"
                                                                                                             th:style="|width:${100-(review.ratingDetail*20)}%|"></div>

                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>

                                                                                        </div>
                                                                                        <div class="tg-rightarea">
                                                                                            <span th:text="${review.reviewDate}"></span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <th:block
                                                                                            th:if="${review.content !=null and review.content !=''}">
                                                                                        <div class="tg-description">
                                                                                            <div th:text="${review.content}"
                                                                                                 th:id="|review-${review.reviewId}|"
                                                                                                 class="truncate-description-2"></div>
                                                                                            <button th:id="|show-more-review-btn-${review.reviewId}|"
                                                                                                    th:onclick="|showMoreReview(${review.reviewId})|"
                                                                                                    class="show-content"
                                                                                                    style=" background-color: #FCFCFC;">
                                                                                                Show more <i
                                                                                                    class="fa-solid fa-angle-down"></i>
                                                                                            </button>
                                                                                        </div>

                                                                                        <div class="like-comment-review">
                                                                                            <span><a
                                                                                                    type="button"
                                                                                                    class="btn btn-light"><span
                                                                                                    th:text="${review.likes==0?'':review.likes +' likes'}"></span>  </a><a
                                                                                                    type="button"
                                                                                                    class="btn btn-light"
                                                                                                    th:onclick="|showChildComment(${review.reviewId})|">  <span
                                                                                                    th:text="${review.comments==0?'':review.comments + ' comments'}"></span> </a>
                                                                                            </span>
                                                                                            <br>
                                                                                            <span>
                                                                                            <th:block
                                                                                                    th:replace="fragments/likeAndComment :: likeAndComment(${review})"></th:block>
                                                                                            </span>
                                                                                        </div>
                                                                                    </th:block>

                                                                                    <th:block
                                                                                            th:if="${review.content ==null or review.content ==''}">
                                                                                        <div class="tg-description">
                                                                                            <a type="button"
                                                                                               class="btn add-review"><i
                                                                                                    class="fa-solid fa-pen"></i>
                                                                                                Review this book</a>
                                                                                        </div>
                                                                                    </th:block>
                                                                                </div>
                                                                                <div class="tg-bottomarrow"></div>
                                                                            </div>
                                                                            <ul class="tg-childcomment"
                                                                                th:id="|child-comment-${review.reviewId}|"
                                                                                style="display: none">
                                                                                <li th:each="comment:${review.childComments}">
                                                                                    <div class="tg-authorbox">
                                                                                        <figure class="tg-authorimg">
                                                                                            <img th:src="${comment.avatar}"
                                                                                                 alt="image description">
                                                                                        </figure>
                                                                                        <div class="tg-authorinfo">
                                                                                            <div class="tg-authorhead p-0">
                                                                                                <div class="tg-leftarea">
                                                                                                    <div class="tg-authorname">
                                                                                                    <span style="font-weight: 600"
                                                                                                          th:text="${comment.name==''?'Anonymous':comment.name}"></span>

                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="tg-rightarea"
                                                                                                     th:id="|action-comment-${review.reviewId}|">
                                                                                                <span th:text="${comment.commentDate}"
                                                                                                      class="mr-5"></span>

                                                                                                    <span th:if="${comment.userCommentId == review.currentUserId}"><a
                                                                                                            type="button"
                                                                                                            th:onclick="|deleteComment(${comment.id})|"
                                                                                                            class="delete-comment btn"><i
                                                                                                            class="fa-regular fa-trash-can"></i></a></span>
                                                                                                    <span th:if="${comment.userCommentId != review.currentUserId || review.currentUserId==null}"><a
                                                                                                            type="button"
                                                                                                            th:onclick="|reportComment(${comment.id})|"
                                                                                                            class="delete-comment btn"><i
                                                                                                            class="fa-regular fa-flag"></i></a></span>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="tg-description m-0">
                                                                                                <p th:text="${comment.contentOfComment}"></p>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="tg-bottomarrow"></div>
                                                                                    </div>
                                                                                </li>

                                                                                <div class="tg-authorbox your-comment"
                                                                                     th:id="|your-comment-${review.reviewId}|">

                                                                                </div>
                                                                            </ul>
                                                                        </li>

                                                                    </ul>
                                                                </th:block>

                                                            </div>

                                                        </div>
                                                        <div role="tabpanel" class="tg-tab-pane tab-pane" id="review">
                                                            <div class="tg-commentsarea">
                                                                <div class="tg-sectionhead">
                                                                    <h2 th:text="${'Total '+reviewsList.size+' Reviews'}"></h2>
                                                                </div>
                                                                <ul id="tg-comments" class="tg-comments">
                                                                    <li th:each="review:${reviewsList}">
                                                                        <div class="tg-authorbox">
                                                                            <figure class="tg-authorimg">
                                                                                <img th:src="${review.avatar}"
                                                                                     alt="image description">
                                                                                <div class="tg-authorname mt-20">
                                                                                    <h2 th:text="${review.name}">
                                                                                        Kathrine </h2>

                                                                                    <th:block
                                                                                            th:replace="fragments/following :: following(${review.following},${review.userReviewId})"></th:block>
                                                                                </div>
                                                                            </figure>
                                                                            <div class="tg-authorinfo">
                                                                                <div class="tg-authorhead">
                                                                                    <div class="tg-leftarea">
                                                                                        <div class="tg-authorname">
                                                                                            <div class="display-rating-reivew">
                                                                                                <div class="stars">
                                                                                                    <svg viewBox="0 0 940.688 940.688">
                                                                                                        <path
                                                                                                                d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                                                    </svg>
                                                                                                    <svg viewBox="0 0 940.688 940.688">
                                                                                                        <path
                                                                                                                d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                                                    </svg>
                                                                                                    <svg viewBox="0 0 940.688 940.688">
                                                                                                        <path
                                                                                                                d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                                                    </svg>
                                                                                                    <svg viewBox="0 0 940.688 940.688">
                                                                                                        <path
                                                                                                                d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                                                    </svg>
                                                                                                    <svg viewBox="0 0 940.688 940.688">
                                                                                                        <path
                                                                                                                d="M885.344,319.071l-258-3.8l-102.7-264.399c-19.8-48.801-88.899-48.801-108.6,0l-102.7,264.399l-258,3.8 c-53.4,3.101-75.1,70.2-33.7,103.9l209.2,181.4l-71.3,247.7c-14,50.899,41.1,92.899,86.5,65.899l224.3-122.7l224.3,122.601 c45.4,27,100.5-15,86.5-65.9l-71.3-247.7l209.2-181.399C960.443,389.172,938.744,322.071,885.344,319.071z"/>
                                                                                                    </svg>

                                                                                                    <div class="overlay"
                                                                                                         th:attr="rating=${review.ratingDetail}"
                                                                                                         th:style="|width:${100-(review.ratingDetail*20)}%|"></div>

                                                                                                </div>
                                                                                            </div>
                                                                                        </div>

                                                                                    </div>
                                                                                    <div class="tg-rightarea">
                                                                                        <span th:text="${review.reviewDate}"></span>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="tg-description">
                                                                                    <div th:text="${review.content}"
                                                                                         th:id="|review-${review.reviewId}|"
                                                                                         class="truncate-description-2"></div>
                                                                                    <button th:id="|show-more-review-btn-${review.reviewId}|"
                                                                                            th:onclick="|showMoreReview(${review.reviewId})|"
                                                                                            class="show-content"
                                                                                            style=" background-color: #FCFCFC;">
                                                                                        Show more <i
                                                                                            class="fa-solid fa-angle-down"></i>
                                                                                    </button>
                                                                                </div>
                                                                                <div class="like-comment-review">
                                                                                    <span><a
                                                                                            type="button"
                                                                                            class="btn btn-light"><span
                                                                                            th:text="${review.likes==0?'':review.likes +' likes'}"></span>  </a><a
                                                                                            type="button"
                                                                                            class="btn btn-light"
                                                                                            th:onclick="|showChildComment(${review.reviewId})|">  <span
                                                                                            th:text="${review.childComments.size ==0?'':review.childComments.size + ' comments'}"></span> </a>
                                                                                    </span>
                                                                                    <br>
                                                                                    <span>
                                                                                        <th:block
                                                                                                th:replace="fragments/likeAndComment :: likeAndComment(${review})"></th:block>
                                                                                    </span>
                                                                                </div>
                                                                            </div>
                                                                            <div class="tg-bottomarrow"></div>
                                                                        </div>
                                                                        <ul class="tg-childcomment"
                                                                            th:id="|child-comment-${review.reviewId}|"
                                                                            style="display: none">
                                                                            <li th:each="comment:${review.childComments}">
                                                                                <div class="tg-authorbox">
                                                                                    <figure class="tg-authorimg">
                                                                                        <img th:src="${comment.avatar}"
                                                                                             alt="image description">
                                                                                    </figure>
                                                                                    <div class="tg-authorinfo">
                                                                                        <div class="tg-authorhead p-0">
                                                                                            <div class="tg-leftarea">
                                                                                                <div class="tg-authorname">
                                                                                                    <span style="font-weight: 600"
                                                                                                          th:text="${comment.name==''?'Anonymous':comment.name}"></span>

                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="tg-rightarea"
                                                                                                 th:id="|action-comment-${review.reviewId}|">
                                                                                                <span th:text="${comment.commentDate}"
                                                                                                      class="mr-5"></span>

                                                                                                <span th:if="${comment.userCommentId == review.currentUserId}"><a
                                                                                                        type="button"
                                                                                                        th:onclick="|deleteComment(${comment.id})|"
                                                                                                        class="delete-comment btn"><i
                                                                                                        class="fa-regular fa-trash-can"></i></a></span>
                                                                                                <span th:if="${comment.userCommentId != review.currentUserId || review.currentUserId==null}"><a
                                                                                                        type="button"
                                                                                                        th:onclick="|reportComment(${comment.id})|"
                                                                                                        class="delete-comment btn"><i
                                                                                                        class="fa-regular fa-flag"></i></a></span>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="tg-description m-0">
                                                                                            <p th:text="${comment.contentOfComment}"></p>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="tg-bottomarrow"></div>
                                                                                </div>
                                                                            </li>

                                                                            <div class="tg-authorbox your-comment"
                                                                                 th:id="|your-comment-${review.reviewId}|">

                                                                            </div>
                                                                        </ul>
                                                                    </li>

                                                                    <!--                                                                    <li class="tg-loadmore"><a-->
                                                                    <!--                                                                            class="tg-btn tg-active"-->
                                                                    <!--                                                                            href="javascript:void(0);">View All</a>-->
                                                                    <!--                                                                    </li>-->
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!--                                            <div class="tg-relatedproducts">-->
                                            <!--                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">-->
                                            <!--                                                    <div class="tg-sectionhead">-->
                                            <!--                                                        <h2><span>Related Products</span>You May Also Like</h2>-->
                                            <!--                                                        <a class="tg-btn" href="javascript:void(0);">View All</a>-->
                                            <!--                                                    </div>-->
                                            <!--                                                </div>-->
                                            <!--                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">-->
                                            <!--                                                    <div id="tg-relatedproductslider"-->
                                            <!--                                                         class="tg-relatedproductslider tg-relatedbooks owl-carousel">-->
                                            <!--                                                        <div class="item">-->
                                            <!--                                                            <div class="tg-postbook">-->
                                            <!--                                                                <figure class="tg-featureimg">-->
                                            <!--                                                                    <div class="tg-bookimg">-->
                                            <!--                                                                        <div class="tg-frontcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-01.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                        <div class="tg-backcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-01.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <a class="tg-btnaddtowishlist"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="icon-heart"></i>-->
                                            <!--                                                                        <span>add to wishlist</span>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </figure>-->
                                            <!--                                                                <div class="tg-postbookcontent">-->
                                            <!--                                                                    <ul class="tg-bookscategories">-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Adventure</a>-->
                                            <!--                                                                        </li>-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Fun</a></li>-->
                                            <!--                                                                    </ul>-->
                                            <!--                                                                    <div class="tg-themetagbox"><span-->
                                            <!--                                                                            class="tg-themetag">sale</span>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <div class="tg-booktitle">-->
                                            <!--                                                                        <h3><a href="javascript:void(0);">Help Me Find-->
                                            <!--                                                                            My-->
                                            <!--                                                                            Stomach</a></h3>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <span class="tg-bookwriter">By: <a-->
                                            <!--                                                                            href="javascript:void(0);">Angela Gunning</a></span>-->
                                            <!--                                                                    <span class="tg-stars"><span></span></span>-->
                                            <!--                                                                    <span class="tg-bookprice">-->
                                            <!--																		<ins>$25.18</ins>-->
                                            <!--																		<del>$27.20</del>-->
                                            <!--																	</span>-->
                                            <!--                                                                    <a class="tg-btn tg-btnstyletwo"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="fa fa-shopping-basket"></i>-->
                                            <!--                                                                        <em>Add To Basket</em>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </div>-->
                                            <!--                                                            </div>-->
                                            <!--                                                        </div>-->
                                            <!--                                                        <div class="item">-->
                                            <!--                                                            <div class="tg-postbook">-->
                                            <!--                                                                <figure class="tg-featureimg">-->
                                            <!--                                                                    <div class="tg-bookimg">-->
                                            <!--                                                                        <div class="tg-frontcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-02.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                        <div class="tg-backcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-02.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <a class="tg-btnaddtowishlist"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="icon-heart"></i>-->
                                            <!--                                                                        <span>add to wishlist</span>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </figure>-->
                                            <!--                                                                <div class="tg-postbookcontent">-->
                                            <!--                                                                    <ul class="tg-bookscategories">-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Adventure</a>-->
                                            <!--                                                                        </li>-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Fun</a></li>-->
                                            <!--                                                                    </ul>-->
                                            <!--                                                                    <div class="tg-themetagbox"><span-->
                                            <!--                                                                            class="tg-themetag">sale</span>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <div class="tg-booktitle">-->
                                            <!--                                                                        <h3><a href="javascript:void(0);">Drive Safely,-->
                                            <!--                                                                            No-->
                                            <!--                                                                            Bumping</a></h3>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <span class="tg-bookwriter">By: <a-->
                                            <!--                                                                            href="javascript:void(0);">Angela Gunning</a></span>-->
                                            <!--                                                                    <span class="tg-stars"><span></span></span>-->
                                            <!--                                                                    <span class="tg-bookprice">-->
                                            <!--																		<ins>$25.18</ins>-->
                                            <!--																		<del>$27.20</del>-->
                                            <!--																	</span>-->
                                            <!--                                                                    <a class="tg-btn tg-btnstyletwo"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="fa fa-shopping-basket"></i>-->
                                            <!--                                                                        <em>Add To Basket</em>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </div>-->
                                            <!--                                                            </div>-->
                                            <!--                                                        </div>-->
                                            <!--                                                        <div class="item">-->
                                            <!--                                                            <div class="tg-postbook">-->
                                            <!--                                                                <figure class="tg-featureimg">-->
                                            <!--                                                                    <div class="tg-bookimg">-->
                                            <!--                                                                        <div class="tg-frontcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-03.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                        <div class="tg-backcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-03.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <a class="tg-btnaddtowishlist"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="icon-heart"></i>-->
                                            <!--                                                                        <span>add to wishlist</span>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </figure>-->
                                            <!--                                                                <div class="tg-postbookcontent">-->
                                            <!--                                                                    <ul class="tg-bookscategories">-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Adventure</a>-->
                                            <!--                                                                        </li>-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Fun</a></li>-->
                                            <!--                                                                    </ul>-->
                                            <!--                                                                    <div class="tg-themetagbox"></div>-->
                                            <!--                                                                    <div class="tg-booktitle">-->
                                            <!--                                                                        <h3><a href="javascript:void(0);">Let The Good-->
                                            <!--                                                                            Times-->
                                            <!--                                                                            Roll Up</a></h3>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <span class="tg-bookwriter">By: <a-->
                                            <!--                                                                            href="javascript:void(0);">Angela Gunning</a></span>-->
                                            <!--                                                                    <span class="tg-stars"><span></span></span>-->
                                            <!--                                                                    <span class="tg-bookprice">-->
                                            <!--																		<ins>$25.18</ins>-->
                                            <!--																		<del>$27.20</del>-->
                                            <!--																	</span>-->
                                            <!--                                                                    <a class="tg-btn tg-btnstyletwo"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="fa fa-shopping-basket"></i>-->
                                            <!--                                                                        <em>Add To Basket</em>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </div>-->
                                            <!--                                                            </div>-->
                                            <!--                                                        </div>-->
                                            <!--                                                        <div class="item">-->
                                            <!--                                                            <div class="tg-postbook">-->
                                            <!--                                                                <figure class="tg-featureimg">-->
                                            <!--                                                                    <div class="tg-bookimg">-->
                                            <!--                                                                        <div class="tg-frontcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-04.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                        <div class="tg-backcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-04.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <a class="tg-btnaddtowishlist"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="icon-heart"></i>-->
                                            <!--                                                                        <span>add to wishlist</span>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </figure>-->
                                            <!--                                                                <div class="tg-postbookcontent">-->
                                            <!--                                                                    <ul class="tg-bookscategories">-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Adventure</a>-->
                                            <!--                                                                        </li>-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Fun</a></li>-->
                                            <!--                                                                    </ul>-->
                                            <!--                                                                    <div class="tg-themetagbox"><span-->
                                            <!--                                                                            class="tg-themetag">sale</span>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <div class="tg-booktitle">-->
                                            <!--                                                                        <h3><a href="javascript:void(0);">Our State Fair-->
                                            <!--                                                                            Is-->
                                            <!--                                                                            A Great State Fair</a></h3>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <span class="tg-bookwriter">By: <a-->
                                            <!--                                                                            href="javascript:void(0);">Angela Gunning</a></span>-->
                                            <!--                                                                    <span class="tg-stars"><span></span></span>-->
                                            <!--                                                                    <span class="tg-bookprice">-->
                                            <!--																		<ins>$25.18</ins>-->
                                            <!--																		<del>$27.20</del>-->
                                            <!--																	</span>-->
                                            <!--                                                                    <a class="tg-btn tg-btnstyletwo"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="fa fa-shopping-basket"></i>-->
                                            <!--                                                                        <em>Add To Basket</em>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </div>-->
                                            <!--                                                            </div>-->
                                            <!--                                                        </div>-->
                                            <!--                                                        <div class="item">-->
                                            <!--                                                            <div class="tg-postbook">-->
                                            <!--                                                                <figure class="tg-featureimg">-->
                                            <!--                                                                    <div class="tg-bookimg">-->
                                            <!--                                                                        <div class="tg-frontcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-05.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                        <div class="tg-backcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-05.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <a class="tg-btnaddtowishlist"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="icon-heart"></i>-->
                                            <!--                                                                        <span>add to wishlist</span>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </figure>-->
                                            <!--                                                                <div class="tg-postbookcontent">-->
                                            <!--                                                                    <ul class="tg-bookscategories">-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Adventure</a>-->
                                            <!--                                                                        </li>-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Fun</a></li>-->
                                            <!--                                                                    </ul>-->
                                            <!--                                                                    <div class="tg-themetagbox"></div>-->
                                            <!--                                                                    <div class="tg-booktitle">-->
                                            <!--                                                                        <h3><a href="javascript:void(0);">Put The Petal-->
                                            <!--                                                                            To-->
                                            <!--                                                                            The Metal</a></h3>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <span class="tg-bookwriter">By: <a-->
                                            <!--                                                                            href="javascript:void(0);">Angela Gunning</a></span>-->
                                            <!--                                                                    <span class="tg-stars"><span></span></span>-->
                                            <!--                                                                    <span class="tg-bookprice">-->
                                            <!--																		<ins>$25.18</ins>-->
                                            <!--																		<del>$27.20</del>-->
                                            <!--																	</span>-->
                                            <!--                                                                    <a class="tg-btn tg-btnstyletwo"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="fa fa-shopping-basket"></i>-->
                                            <!--                                                                        <em>Add To Basket</em>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </div>-->
                                            <!--                                                            </div>-->
                                            <!--                                                        </div>-->
                                            <!--                                                        <div class="item">-->
                                            <!--                                                            <div class="tg-postbook">-->
                                            <!--                                                                <figure class="tg-featureimg">-->
                                            <!--                                                                    <div class="tg-bookimg">-->
                                            <!--                                                                        <div class="tg-frontcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-06.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                        <div class="tg-backcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-06.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <a class="tg-btnaddtowishlist"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="icon-heart"></i>-->
                                            <!--                                                                        <span>add to wishlist</span>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </figure>-->
                                            <!--                                                                <div class="tg-postbookcontent">-->
                                            <!--                                                                    <ul class="tg-bookscategories">-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Adventure</a>-->
                                            <!--                                                                        </li>-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Fun</a></li>-->
                                            <!--                                                                    </ul>-->
                                            <!--                                                                    <div class="tg-themetagbox"><span-->
                                            <!--                                                                            class="tg-themetag">sale</span>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <div class="tg-booktitle">-->
                                            <!--                                                                        <h3><a href="javascript:void(0);">Help Me Find-->
                                            <!--                                                                            My-->
                                            <!--                                                                            Stomach</a></h3>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <span class="tg-bookwriter">By: <a-->
                                            <!--                                                                            href="javascript:void(0);">Angela Gunning</a></span>-->
                                            <!--                                                                    <span class="tg-stars"><span></span></span>-->
                                            <!--                                                                    <span class="tg-bookprice">-->
                                            <!--																		<ins>$25.18</ins>-->
                                            <!--																		<del>$27.20</del>-->
                                            <!--																	</span>-->
                                            <!--                                                                    <a class="tg-btn tg-btnstyletwo"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="fa fa-shopping-basket"></i>-->
                                            <!--                                                                        <em>Add To Basket</em>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </div>-->
                                            <!--                                                            </div>-->
                                            <!--                                                        </div>-->
                                            <!--                                                        <div class="item">-->
                                            <!--                                                            <div class="tg-postbook">-->
                                            <!--                                                                <figure class="tg-featureimg">-->
                                            <!--                                                                    <div class="tg-bookimg">-->
                                            <!--                                                                        <div class="tg-frontcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-03.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                        <div class="tg-backcover"><img-->
                                            <!--                                                                                th:src="@{/original/images/books/img-03.jpg}"-->
                                            <!--                                                                                alt="image description"></div>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <a class="tg-btnaddtowishlist"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="icon-heart"></i>-->
                                            <!--                                                                        <span>add to wishlist</span>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </figure>-->
                                            <!--                                                                <div class="tg-postbookcontent">-->
                                            <!--                                                                    <ul class="tg-bookscategories">-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Adventure</a>-->
                                            <!--                                                                        </li>-->
                                            <!--                                                                        <li><a href="javascript:void(0);">Fun</a></li>-->
                                            <!--                                                                    </ul>-->
                                            <!--                                                                    <div class="tg-themetagbox"></div>-->
                                            <!--                                                                    <div class="tg-booktitle">-->
                                            <!--                                                                        <h3><a href="javascript:void(0);">Let The Good-->
                                            <!--                                                                            Times-->
                                            <!--                                                                            Roll Up</a></h3>-->
                                            <!--                                                                    </div>-->
                                            <!--                                                                    <span class="tg-bookwriter">By: <a-->
                                            <!--                                                                            href="javascript:void(0);">Angela Gunning</a></span>-->
                                            <!--                                                                    <span class="tg-stars"><span></span></span>-->
                                            <!--                                                                    <span class="tg-bookprice">-->
                                            <!--																		<ins>$25.18</ins>-->
                                            <!--																		<del>$27.20</del>-->
                                            <!--																	</span>-->
                                            <!--                                                                    <a class="tg-btn tg-btnstyletwo"-->
                                            <!--                                                                       href="javascript:void(0);">-->
                                            <!--                                                                        <i class="fa fa-shopping-basket"></i>-->
                                            <!--                                                                        <em>Add To Basket</em>-->
                                            <!--                                                                    </a>-->
                                            <!--                                                                </div>-->
                                            <!--                                                            </div>-->
                                            <!--                                                        </div>-->
                                            <!--                                                    </div>-->
                                            <!--                                                </div>-->
                                            <!--                                            </div>-->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-4 col-md-4 col-lg-3 pull-left">
                                <th:block id="tg-sidebar" th:replace="fragments/sidebar :: sidebar"></th:block>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--************************************
                    News Grid End
            *************************************-->
        </main>
        <!--************************************
                Main End
        *************************************-->
    </th:block>
    <!--************************************
            Footer Start
    *************************************-->
    <th:block id="footer" th:replace="fragments/footer :: footer"></th:block>
    <!--************************************
            Footer End
    *************************************-->
</div>
<!--************************************
        Wrapper End
*************************************-->

<th:block id="js">
    <script th:inline="javascript">
        let bookDetail = [[${bookDetail}]];
        let bookId = bookDetail.id;
        let reviewsList = [[${reviewsList}]];
        let myReview = [[${myReview}]]
        console.log(myReview)

        function showMore() {
            if ($('#book-description').hasClass("truncate-description")) {
                $('#book-description').removeClass("truncate-description");
                $('#show-more-btn').html(`Show less <i class="fa-solid fa-angle-up"></i>`);
            } else {
                $('#book-description').addClass("truncate-description");
                $('#show-more-btn').html(`Show more <i class="fa-solid fa-angle-down"></i>`);
            }
        }

        function showMoreReview(reviewId) {
            if ($(`#review-${reviewId}`).hasClass("truncate-description-2")) {
                $(`#review-${reviewId}`).removeClass("truncate-description-2");
                $(`#show-more-review-btn-${reviewId}`).html(`Show less <i class="fa-solid fa-angle-up"></i>`);
            } else {
                $(`#review-${reviewId}`).addClass("truncate-description-2");
                $(`#show-more-review-btn-${reviewId}`).html(`Show more <i class="fa-solid fa-angle-down"></i>`);
            }
        }

        function showChildComment(reviewId) {
            if ($(`#child-comment-${reviewId}`).is(':hidden')) {
                $(`#child-comment-${reviewId}`).show()
            } else {
                $(`#child-comment-${reviewId}`).hide()
            }
        }

        function showAndFocusOnCommentInput(reviewId) {
            if ($(`#child-comment-${reviewId}`).is(':hidden')) {
                $(`#child-comment-${reviewId}`).show()
            }
            try {
                $('html, body').animate({
                    scrollTop: $(`#comment-input-${reviewId}`).offset().top - 100
                }, 700);
                $(`#comment-input-${reviewId}`).focus();
            } catch (e) {
                console.log(e)
            }
        }

        function likeReview(reviewId, liked) {
            let typeMethod = 'POST';
            if (liked === true) {
                typeMethod = 'DELETE';
            }
            $.ajax({
                url: '/api/v1/users/like/' + reviewId,
                type: typeMethod,
                success: function (data) {
                    autoDirectLoginPage(data);
                }, error: function () {
                    toastr.warning('Not success')
                }
            })
        }

        function changeText(link) {
            link.textContent = "UnFollow";
        }

        function restoreText(link) {
            link.textContent = "Following";
        }

        function deleteComment(commentId) {
            if (window.confirm('Delete this comment?')) {
                $.ajax({
                    url: '/api/v1/users/comment/' + commentId,
                    type: 'DELETE',
                    success: function (data) {
                        toastr.success("Delete comment successfully");
                        setTimeout(function () {
                            window.location.reload();
                        }, 600)
                    }, error: function () {
                        toastr.warning('Cannot delete this comment!');
                    }
                })
            }
        }

        function reportComment(commentId) {
            if (!localStorage.getItem("jwtToken")) {
                window.location.href = '/login';
            } else {
                if (window.confirm('Report this comment?')) {
                    toastr.success("Sent your report successfully!")
                }
            }
        }

        $(window).on('load', function () {

            function checkUserLogin() {
                const jwtToken = localStorage.getItem("jwtToken");

                let commentHtml;
                if (!jwtToken) {
                    commentHtml = `
                 <div class="tg-authorinfo" style="padding-bottom: 17px">
                    <p><a href="/login" class="register-page">Sign in</a> or
                        <a href="/signup" class="register-page">Create a free account</a>
                        to leave a comment</p>
                 </div>
                 <div class="tg-bottomarrow"></div>
                `
                    for (let i = 0; i < reviewsList.length; i++) {
                        $('.your-comment').html(commentHtml)
                    }
                } else {
                    const avatar = JSON.parse(localStorage.getItem('userInfomation')).avatar
                    for (let i = 0; i < reviewsList.length; i++) {
                        let review = reviewsList[i];
                        commentHtml = `
                 <figure class="tg-authorimg"><img src="${avatar}" alt="image description"> </figure>
                 <div class="tg-authorinfo" style="padding-bottom: 17px">
                    <textarea type="text" placeholder="Add a comment"
                      id="comment-input-${review.reviewId}" style="width: 100%; text-transform: none"></textarea>
                       <div class="tg-rightarea mt-10">
                        <a class="tg-btnreply fs-12 btn submit-comment-btn"
                            review-id="${review.reviewId}" href="javascript:void(0);">Post
                            <i class="fa fa-mail-reply"></i></a>
                       </div>
                 </div>
                 <div class="tg-bottomarrow"></div>
                `
                        $(`#your-comment-${review.reviewId}`).html(commentHtml)
                    }
                }
            }

            checkUserLogin();

            $(document).ready(function () {
                $('.follow').on('click', function (event) {
                    event.preventDefault();
                    let userAcceptId = $(event.currentTarget).attr("user-accept-id");
                    let isFollowing = $(event.currentTarget).attr("is-following");
                    let typeMethod = 'POST';
                    if (isFollowing === '1') {
                        typeMethod = 'DELETE'
                    }
                    $.ajax({
                        url: '/api/v1/users/following/' + userAcceptId,
                        type: typeMethod,
                        success: function (data) {
                            autoDirectLoginPage(data);

                        }, error: function () {
                            toastr.warning('Not success')
                        }
                    })
                })
                $('.submit-comment-btn').on('click', function (event) {
                    event.preventDefault();
                    let reviewId = $(event.currentTarget).attr("review-id")
                    console.log(reviewId)
                    let commentContent = $(`#comment-input-${reviewId}`).val().trim()

                    if (commentContent.length >= 65535) {
                        toastr.warning('Comment cannot be longer than 65535 characters');
                        return;
                    } else if (commentContent === '') {
                        return;
                    }
                    $('.submit-comment-btn').toggleClass('disabled-link');
                    let formData = {
                        reviewId: reviewId,
                        content: commentContent
                    }
                    $.ajax({
                        url: '/api/v1/users/comment',
                        type: 'POST',
                        data: JSON.stringify(formData),
                        contentType: 'application/json',
                        success: function (data) {
                            autoDirectLoginPage(data);
                            $('.submit-comment-btn').toggleClass('disabled-link');
                            // window.location.reload()

                        }, error: function () {
                            toastr.warning('Post comment not success')
                            $('.submit-comment-btn').toggleClass('disabled-link');
                        }
                    })
                })
            })


        })

    </script>
    <script th:src="@{/handle/rating-review.js}"></script>

</th:block>
</body>

</html>